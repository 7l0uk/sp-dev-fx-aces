define("8f47beca-497f-4af8-994a-4144dec4406e_0.0.2",["@microsoft/sp-core-library","@microsoft/sp-http"],function(n,a){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({UWqr:function(e,t){e.exports=n},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphClientLibrary",function(){return a}),n.d(t,"GraphClientProvider",function(){return m});var a=function(){function e(){}return e.prototype.name=function(){return"GraphClientLibrary"},e}(),i=n("UWqr"),r=n("vlQI"),o=function(){return o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=function(){function e(e){this.httpClient=e}return e.prototype.get=function(e,t){return this.httpClient.get(e,r.AadHttpClient.configurations.v1,o(o({},t),{headers:o(o({},null==t?void 0:t.headers),{Accept:"application/json",ConsistencyLevel:"eventual","Content-Type":"application/json"})}))},e.prototype.post=function(e,t){return this.httpClient.post(e,r.AadHttpClient.configurations.v1,t)},e.prototype.patch=function(e,t){return this.httpClient.fetch(e,r.AadHttpClient.configurations.v1,o(o({},t),{headers:o(o({},null==t?void 0:t.headers),{Accept:"application/json",ConsistencyLevel:"eventual","Content-Type":"application/json"}),method:"PATCH"}))},e.prototype.put=function(e,t){return this.httpClient.fetch(e,r.AadHttpClient.configurations.v1,o(o({},t),{headers:o(o({},null==t?void 0:t.headers),{Accept:"application/json",ConsistencyLevel:"eventual","Content-Type":"application/json"}),method:"PUT"}))},e.prototype.delete=function(e){return this.httpClient.fetch(e,r.AadHttpClient.configurations.v1,{method:"DELETE"})},e}(),c=function(){function e(){}return e.splitToMaxLength=function(e,t){for(var n=[],a=0;a<e.length;)n.push(e.slice(a,a+t)),a+=t;return n},e.getSubMap=function(e,t){var n=new Map;return t.forEach(function(t){return n.set(t,e.get(t))}),n},e}(),d=function(){return d=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},d.apply(this,arguments)},l=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},u=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},f=function(){function e(e,t,n,a){void 0===a&&(a=0);var i=this;this.baseClient=e,this.registeredPromises=t,this.batch=n,this.retries=a,this.requestBatch=function(e,t){return void 0===t&&(t="beta"),l(i,void 0,void 0,function(){var n,a;return u(this,function(i){switch(i.label){case 0:return n={headers:{Accept:"application/json",ConsistencyLevel:"eventual","Content-Type":"application/json"},body:e},[4,this.baseClient.post("https://graph.microsoft.com/".concat(t,"/$batch"),n)];case 1:return(a=i.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,i.sent()];case 3:return[2]}})})}}return e.prototype.executeBatch=function(){return l(this,void 0,void 0,function(){var e,t,n,a,i,r,o;return u(this,function(s){switch(s.label){case 0:return e=this.batch.filter(function(e){return e.url.indexOf("v1.0/")<0}),t=this.batch.filter(function(e){return e.url.indexOf("v1.0/")>=0}),n=JSON.stringify({requests:e}),a=JSON.stringify({requests:t.map(function(e){return d(d({},e),{url:e.url.replace("v1.0/","")})})}),i=[],e.length>0?[4,this.requestBatch(n)]:[3,2];case 1:r=s.sent(),i.push.apply(i,r.responses),s.label=2;case 2:return t.length>0?[4,this.requestBatch(a,"v1.0")]:[3,4];case 3:o=s.sent(),i.push.apply(i,o.responses),s.label=4;case 4:return this.processBatchResponse(i),this.batch.length>0&&this.retries>0&&(this.retries--,this.executeBatch()),[2]}})})},e.prototype.processBatchResponse=function(e){var t=this,n=[],a=new Map;this.registeredPromises.forEach(function(i,r){var o=e.filter(function(e){return e.id===r})[0];o&&429===o.status&&t.retries>0?(n.push({url:r,id:r,method:"GET"}),a.set(r,i)):t.handleSingleResponse(o,i)}),n.length>0?(this.registeredPromises=a,this.batch=n):(this.batch=[],this.registeredPromises.clear())},e.prototype.handleSingleResponse=function(e,t){e?t.forEach(function(t){t.resolve({json:function(){return Promise.resolve(e.body)},ok:200===e.status,text:function(){return Promise.resolve(JSON.stringify(e.body))}})}):t.forEach(function(t){t.error({json:function(){return Promise.resolve(e)},ok:!1,text:function(){return Promise.resolve(JSON.stringify(e))}})})},e.maxRetries=5,e}(),p=function(){function e(e,t,n){void 0===t&&(t=500),void 0===n&&(n=15);var a=this;this.baseClient=e,this.batchWaitTime=t,this.batchSplitThreshold=n,this.batch=[],this.registeredPromises=new Map,this.generateBatch=function(){return e=a,void 0,n=function(){var e,t,n,a,i,r,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(s){switch(s.label){case 0:e=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],this.batch,!0),this.batch=[],t=new Map(this.registeredPromises),this.registeredPromises.clear(),n=c.splitToMaxLength(e,this.batchSplitThreshold),a=0,i=n,s.label=1;case 1:return a<i.length?(r=i[a],o=c.getSubMap(t,r.map(function(e){return e.id})),[4,new f(this.baseClient,o,r,f.maxRetries).executeBatch()]):[3,4];case 2:s.sent(),s.label=3;case 3:return a++,[3,1];case 4:return[2]}})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},this.createGetBatchRequest=function(e,t){0===a.batch.length&&setTimeout(a.generateBatch,a.batchWaitTime);var n=encodeURIComponent(e),i=new URL(e,"https://graph.microsoft.com"),r=i.pathname+i.search;a.batch.filter(function(e){return e.id===n})[0]?a.registeredPromises.get(n).push(t):(a.batch.push({url:r,id:n,method:"GET",headers:{ConsistencyLevel:"eventual"}}),a.registeredPromises.set(n,[t]))}}return e.prototype.get=function(e,t){var n=this;return new Promise(function(t,a){n.createGetBatchRequest(e,{resolve:t,error:a})})},e.prototype.post=function(e,t){return this.baseClient.post(e,t)},e.prototype.patch=function(e,t){return this.baseClient.patch(e,t)},e.prototype.put=function(e,t){return this.baseClient.put(e,t)},e.prototype.delete=function(e){return this.baseClient.delete(e)},e}(),m=function(){function e(e){var t=this;this.serviceScope=e,e.whenFinished(function(){return t.clientFactory=e.consume(r.AadHttpClientFactory.serviceKey)})}return e.prototype.getGraphClient=function(){return e=this,void 0,n=function(){var e,t;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(n){switch(n.label){case 0:return this.client?[3,2]:[4,this.clientFactory.getClient("https://graph.microsoft.com")];case 1:e=n.sent(),t=new s(e),this.client=new p(t),n.label=2;case 2:return[2,this.client]}})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},e.serviceKey=i.ServiceKey.create("pnp-sample:GraphClientProvider",e),e}()},vlQI:function(e,t){e.exports=a}})});